# 常见问题解答 (FAQ)

## 目录
- [安装和启动](#安装和启动)
- [文件处理](#文件处理)
- [列名映射](#列名映射)
- [数据处理](#数据处理)
- [错误和故障排除](#错误和故障排除)
- [性能问题](#性能问题)

---

## 安装和启动

### Q1: Windows上双击run_windows.bat没反应？
**A**: 请检查以下几点：
1. 是否安装了Python 3.9+？在命令行输入 `python --version` 检查
2. Python是否添加到PATH？重新安装Python并勾选"Add Python to PATH"
3. 尝试右键以管理员身份运行 `run_windows.bat`
4. 查看错误信息，可能需要手动安装依赖

### Q2: macOS上提示"Permission denied"？
**A**: 需要给脚本添加执行权限：
```bash
chmod +x run_mac_linux.sh
./run_mac_linux.sh
```

### Q3: 程序启动后立即关闭？
**A**:
1. 在命令行中手动运行查看错误信息
2. 检查 `logs/` 目录下的日志文件
3. 确保已安装所有依赖：`pip install -r requirements.txt`

### Q4: 提示"未检测到python3"？
**A**:
- Windows: 使用 `python` 而不是 `python3`
- macOS/Linux: 确保安装了Python 3，或创建软链接 `python3`

---

## 文件处理

### Q5: 支持哪些文件格式？
**A**: 支持以下格式：
- Excel: `.xlsx`, `.xls`
- CSV: `.csv`
- 文本: `.txt`（需要是表格格式）

### Q6: 文件读取失败提示编码错误？
**A**: 程序会自动尝试多种编码（UTF-8, GBK, Latin1），如果仍然失败：
1. 用Excel打开CSV文件，另存为UTF-8编码
2. 检查文件是否损坏
3. 确认文件格式是否正确

### Q7: Excel文件提示"File is not a zip file"？
**A**:
- `.xls` 格式的文件可能损坏
- 尝试用Excel打开并另存为 `.xlsx` 格式
- 检查文件扩展名是否正确

### Q8: 可以合并多少个文件？
**A**: 理论上没有限制，但建议：
- 文件数量：≤ 100个
- 总数据量：≤ 100MB
- 单个文件：≤ 50MB
超过建议值可能导致内存不足或处理缓慢

---

## 列名映射

### Q9: 如何添加自定义列名映射？
**A**:
1. 点击 "⚙️ 列名映射配置" 按钮
2. 编辑JSON格式的配置
3. 格式：`"标准列名": ["别名1", "别名2"]`
4. 点击"保存配置"

### Q10: 列名映射不生效？
**A**: 检查以下几点：
1. 是否勾选了"统一列名（使用映射规则）"
2. 配置文件中是否包含该列名
3. 查看日志中的"列名映射报告"
4. 列名是否完全匹配（包括空格、符号）

### Q11: 为什么有些列名没有被映射？
**A**:
- 默认只进行精确匹配
- 如需模糊匹配，勾选"启用模糊匹配"
- 模糊匹配可能有误判，建议先不启用，根据映射报告调整配置

### Q12: 映射后出现重复列名（如：品牌_1, 品牌_2）？
**A**:
- 这是正常的，说明多个原列名被映射到同一个标准列名
- 程序自动添加后缀避免冲突
- 建议检查配置，确保映射规则合理

---

## 数据处理

### Q13: "智能去重"和"删除重复行"有什么区别？
**A**:
- **删除重复行**: 删除所有列都完全相同的行
- **智能去重**: 根据指定的关键字段去重
  - 例如：关键字段填"商品条码,日期"
  - 只删除商品条码和日期都相同的行

### Q14: 去重后数据少了很多？
**A**:
1. 查看日志中显示删除了多少行
2. 检查去重字段是否选择正确
3. 确认是否需要去重
4. 尝试使用"智能去重"而非"删除重复行"

### Q15: 合并后有很多空列？
**A**:
- 原因：不同文件的列名差异较大
- 解决：
  1. 勾选"统一列名"
  2. 完善列名映射配置
  3. 启用"模糊匹配"（谨慎使用）

### Q16: 合并后数据顺序混乱？
**A**:
- 程序按添加文件的顺序合并
- 可以在Excel中使用"排序"功能
- 未来版本可能添加自动排序功能

### Q17: 来源文件列显示文件扩展名？
**A**: 来源文件会自动去掉扩展名（如.csv,.xlsx）

---

## 错误和故障排除

### Q18: 提示"Reindexing only valid with uniquely valued Index objects"？
**A**: 此问题已修复。如仍出现：
1. 更新到最新版本
2. 检查是否有重复的列名
3. 查看日志获取详细错误信息

### Q19: 程序卡死不动？
**A**:
1. 检查是否在处理大文件
2. 查看进度条和状态提示
3. 大文件处理可能需要几分钟
4. 如果超过10分钟无响应，重启程序并减少文件数量

### Q20: 合并完成后找不到输出文件？
**A**:
1. 查看成功提示框中的文件路径
2. 检查是否有写入权限
3. 查看日志文件中的保存路径
4. 尝试保存到不同的位置

### Q21: 日志在哪里查看？
**A**: 日志文件位于 `logs/YYYYMMDD.log`
- 每天一个日志文件
- 包含所有操作记录和错误信息
- 可以用文本编辑器打开

---

## 性能问题

### Q22: 处理速度很慢怎么办？
**A**:
1. 减少一次合并的文件数量
2. 分批处理大量文件
3. 关闭不必要的后台程序释放内存
4. 升级电脑配置（增加内存）

### Q23: 内存不足怎么办？
**A**:
1. 关闭其他占用内存的程序
2. 分批合并文件
3. 单次处理的文件总大小建议不超过100MB

### Q24: 可以处理百万行数据吗？
**A**:
- 理论上可以，取决于电脑配置
- 建议：
  - 8GB内存：最多50万行
  - 16GB内存：最多200万行
  - 32GB+内存：可处理更多

---

## 其他问题

### Q25: 支持横向合并（JOIN）吗？
**A**: 当前版本不支持，仅支持纵向堆叠合并。横向合并功能计划在未来版本添加。

### Q26: 可以保存合并配置吗？
**A**: 列名映射配置会自动保存在 `column_mappings.json` 文件中，下次启动自动加载。

### Q27: 如何备份配置？
**A**: 复制 `column_mappings.json` 文件到其他位置即可。

### Q28: 程序是否会上传我的数据？
**A**: 不会。所有数据处理都在本地进行，不涉及网络传输。

### Q29: 如何卸载程序？
**A**:
1. 删除整个程序文件夹即可
2. 不会在系统其他位置留下文件
3. 虚拟环境也在程序文件夹内

### Q30: 发现Bug如何反馈？
**A**:
1. 查看 `logs/` 目录下的日志文件
2. 记录操作步骤和错误信息
3. 在项目的GitHub Issues页面提交问题

---

## 系统要求

### 最低配置
- 操作系统: Windows 10 / macOS 10.14+ / Linux
- Python: 3.9+
- 内存: 4GB
- 磁盘空间: 500MB

### 推荐配置
- 操作系统: Windows 11 / macOS 13+ / Ubuntu 20.04+
- Python: 3.11+
- 内存: 8GB+
- 磁盘空间: 1GB

---

## 获取帮助

如果以上FAQ没有解决你的问题：

1. **查看文档**:
   - README.md - 使用指南
   - CHANGELOG.md - 更新日志
   - CODE_REVIEW.md - 技术细节

2. **查看日志**:
   - `logs/YYYYMMDD.log`

3. **联系支持**:
   - 提交GitHub Issue
   - 附上日志文件和错误截图

---

**最后更新**: 2025-11-06
**版本**: v1.0
